<!-- --- START OF FILE arc_database_v1.5.0.html --- -->
<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARC RAIDERS // DATABASE v1.5.0</title>
    <style>
        /* FONTS */
        @import url('https://fonts.googleapis.com/css2?family=Barlow:wght@400;500;600;700&family=Rajdhani:wght@500;600;700&family=Teko:wght@300;400;500;600;700&display=swap');

        :root {
            --bg-body: #050505;
            --arc-yellow: #ffc400;
            --arc-white: #e6e6e6;
            --arc-teal: #00e5ff;   
            --arc-red: #ff2a2a;
            
            --sb-inactive-bg: #2b2f3b;
            --sb-active-bg: #f2e8d5;
            --sb-icon-size: 52px;
            --sb-gap: 8px;

            --card-bg: #f2e8d5;
            --card-text: #121418;
            
            --col-common: #7a7a7a;
            --col-uncommon: #009e48;
            --col-rare: #0090d4;
            --col-epic: #a040b0;
            --col-legendary: #ff9600;

            --font-head: 'Teko', sans-serif;
            --font-ui: 'Rajdhani', sans-serif;

            --header-h: 80px;
            --sb-w: 70px;
            --content-pad-left: 130px;
        }

        @media (max-width: 1300px) {
            :root { --header-h: 60px; --sb-w: 60px; --content-pad-left: 100px; }
        }

        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; }

        body {
            background-color: var(--bg-body);
            background: radial-gradient(circle at 50% 30%, #1a1f2e 0%, #050505 80%);
            background-attachment: fixed;
            color: var(--arc-white);
            font-family: var(--font-ui);
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        .layout-container { flex: 1; display: flex; flex-direction: column; padding-top: var(--header-h); }

        header {
            position: fixed; top: 0; left: 0; right: 0; height: var(--header-h);
            background: rgba(0,0,0,0.9); backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex; align-items: center; justify-content: space-between; padding: 0 20px; z-index: 1000;
        }

        .header-left, .header-right { display: flex; align-items: center; gap: 15px; }
        .app-logo { height: 30px; cursor: pointer; }
        .app-logo img { height: 100%; }

        .btn-play {
            background: var(--arc-yellow); color: #000; border: none; border-radius: 40px;
            padding: 8px 20px; font-family: var(--font-head); font-weight: 700; cursor: pointer;
        }

        .nav-links { display: flex; gap: 10px; opacity: 0.3; pointer-events: none; }
        body.db-loaded .nav-links { opacity: 1; pointer-events: auto; }
        .nav-item {
            font-family: var(--font-head); font-size: 1.4rem; color: #888; text-transform: uppercase;
            cursor: pointer; padding: 5px 15px; border-radius: 50px; transition: 0.2s;
        }
        .nav-item.active { color: #fff; background: rgba(255,255,255,0.1); box-shadow: 0 0 10px rgba(255,255,255,0.1); }

        .search-box {
            background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);
            padding: 8px 15px; color: #fff; border-radius: 4px; outline: none; width: 200px;
        }

        .btn-system {
            background: transparent; border: 1px solid rgba(255,255,255,0.3); color: #ccc;
            padding: 6px 15px; border-radius: 20px; cursor: pointer; text-transform: uppercase; font-size: 0.8rem;
        }
        .btn-system.active { border-color: var(--arc-teal); color: var(--arc-teal); }

        /* SIDEBAR */
        aside {
            position: absolute; top: calc(var(--header-h) + 20px); left: 30px; bottom: 20px;
            width: var(--sb-w); display: none; flex-direction: column; gap: var(--sb-gap); z-index: 90;
        }
        body.db-loaded aside { display: flex; }
        .filter-circle {
            width: var(--sb-icon-size); height: var(--sb-icon-size); border-radius: 50%;
            background: var(--sb-inactive-bg); cursor: pointer; transition: 0.2s; overflow: hidden;
            display: flex; align-items: center; justify-content: center; border: 2px solid transparent;
        }
        .filter-circle:hover { transform: scale(1.1); }
        .filter-circle.active { background: var(--sb-active-bg); border-color: var(--sb-active-bg); }
        .filter-circle img { width: 100%; height: 100%; object-fit: cover; }
        
        .filter-circle .icon-active { display: none; }
        .filter-circle.active .icon-active { display: block; }
        .filter-circle.active .icon-inactive { display: none; }

        /* CONTENT */
        .content-area { flex: 1; padding: 20px 40px; overflow-y: auto; transition: padding-left 0.3s; }
        body.db-loaded .content-area { padding-left: var(--content-pad-left); }
        .stash-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; }

        .slot {
            aspect-ratio: 1; background: rgba(20, 20, 25, 0.7); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 3px; display: flex; align-items: center; justify-content: center; position: relative; cursor: pointer;
        }
        .slot:hover { border-color: #fff; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .slot img { max-width: 80%; max-height: 80%; filter: drop-shadow(0 5px 10px rgba(0,0,0,0.5)); }
        .slot::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 3px; opacity: 0.8; }
        .slot.common::after { background: var(--col-common); }
        .slot.uncommon::after { background: var(--col-uncommon); }
        .slot.rare::after { background: var(--col-rare); }
        .slot.epic::after { background: var(--col-epic); }
        .slot.legendary::after { background: var(--col-legendary); }

        #loader { position: fixed; inset: 0; background: #000; display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 10000; }
        .spinner { width: 50px; height: 50px; border: 5px solid #222; border-top-color: var(--arc-yellow); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div id="loader">
    <div class="spinner"></div>
    <h2 style="margin-top:20px; font-family:var(--font-head); letter-spacing:2px;">CARICAMENTO ARCHIVIO...</h2>
</div>

<header>
    <div class="header-left">
        <div class="app-logo" onclick="location.reload()"><img src="images/menu/ARC Raiders.png"></div>
        <div class="nav-links">
            <div class="nav-item active" onclick="setSection('INVENTARIO')" data-nav="INVENTARIO">INVENTARIO</div>
            <div class="nav-item" onclick="setSection('OFFICINA')" data-nav="OFFICINA">OFFICINA</div>
            <div class="nav-item" onclick="setSection('PROGETTI')" data-nav="PROGETTI">PROGETTI</div>
        </div>
    </div>
    <div class="header-right">
        <input type="text" class="search-box" id="searchInput" placeholder="CERCA..." disabled oninput="render()">
        <button class="btn-play" onclick="loadDataRemote()">CONNETTI SPERANZA</button>
        <button class="btn-system" onclick="document.getElementById('folderInput').click()">LOCALE</button>
        <button id="imgModeBtn" class="btn-system active" onclick="toggleImageMode()">IMG: REMOTE</button>
    </div>
</header>

<aside id="sidebarPanel"></aside>

<div class="content-area">
    <div id="grid-container" class="stash-grid">
        <div style="grid-column: 1/-1; text-align: center; margin-top: 20vh; opacity: 0.3;">
            <h1 style="font-size: 4rem;">NO SIGNAL</h1>
            <p>SELEZIONA UNA SORGENTE DATI PER INIZIARE</p>
        </div>
    </div>
</div>

<input type="file" id="folderInput" webkitdirectory directory multiple style="display:none" onchange="loadDataLocal(event)">

<script>
    let itemsDB = [], hideoutDB = [], allImages = new Map();
    let currentSection = 'INVENTARIO', currentFilter = 'ALL', imageMode = 'REMOTE';
    const GITHUB_RAW = 'https://raw.githubusercontent.com/atarufox/Speranza-Archive/main/';

    // Configurazione Sidebar (nomi immagini corrispondenti ai file png nel repo)
    const SIDEBAR_CONFIG = {
        'INVENTARIO': [
            { id: 'ALL', img: 'tutto' },
            { id: 'POTENZIAMENTI', img: 'potenziamenti' },
            { id: 'SCUDI', img: 'scudi' },
            { id: 'ARMI', img: 'armi' },
            { id: 'MUNIZIONI', img: 'munizioni' },
            { id: 'MOD', img: 'mod' },
            { id: 'USO_RAPIDO', img: 'uso_rapido' },
            { id: 'CHIAVI', img: 'chiavi' },
            { id: 'MATERIALI', img: 'crafting' }
        ],
        'OFFICINA': [
            { id: 'ALL', img: 'tutto' },
            { id: 'workbench', img: 'workbench' },
            { id: 'weapon_bench', img: 'weapon_bench' },
            { id: 'scrappy', img: 'scrappy' },
            { id: 'refiner', img: 'refiner' }
        ],
        'PROGETTI': [
            { id: 'ALL', img: 'tutto' },
            { id: 'ARMI', img: 'armi' },
            { id: 'MOD', img: 'mod' }
        ]
    };

    function setSection(section) {
        currentSection = section;
        currentFilter = 'ALL';
        document.querySelectorAll('.nav-item').forEach(n => n.classList.toggle('active', n.dataset.nav === section));
        renderSidebar();
        render();
    }

    function renderSidebar() {
        const sidebar = document.getElementById('sidebarPanel');
        sidebar.innerHTML = "";
        const config = SIDEBAR_CONFIG[currentSection] || [];
        const baseUrl = (imageMode === 'REMOTE') ? GITHUB_RAW : '';

        config.forEach(item => {
            const div = document.createElement('div');
            div.className = `filter-circle ${currentFilter === item.id ? 'active' : ''}`;
            div.onclick = () => { currentFilter = item.id; renderSidebar(); render(); };
            
            // Le immagini caricate dal server o da locale
            div.innerHTML = `
                <img class="icon-inactive" src="${baseUrl}images/menu/${item.img}_inactive.png" onerror="this.style.display='none'">
                <img class="icon-active" src="${baseUrl}images/menu/${item.img}_active.png" onerror="this.style.display='none'">
            `;
            sidebar.appendChild(div);
        });
    }

    async function loadDataRemote() {
        const loader = document.getElementById('loader');
        loader.style.display = 'flex';
        imageMode = 'REMOTE';
        updateImageModeBtn();

        try {
            const repo = 'atarufox/Speranza-Archive';
            // Carica Items
            const itemsRes = await fetch(`https://api.github.com/repos/${repo}/contents/items`);
            const itemsFiles = await itemsRes.json();
            const itemPromises = itemsFiles.filter(f => f.name.endsWith('.json')).map(f => fetch(f.download_url).then(r => r.json()));
            itemsDB = await Promise.all(itemPromises);

            // Carica Hideout
            const hideRes = await fetch(`https://api.github.com/repos/${repo}/contents/hideout`);
            if(hideRes.ok) {
                const hideFiles = await hideRes.json();
                const hidePromises = hideFiles.filter(f => f.name.endsWith('.json')).map(f => fetch(f.download_url).then(r => r.json()));
                hideoutDB = await Promise.all(hidePromises);
            }

            enableUI();
        } catch (e) {
            alert("Errore di connessione al repository.");
            loader.style.display = 'none';
        }
    }

    async function loadDataLocal(e) {
        const files = Array.from(e.target.files);
        if(!files.length) return;
        
        const loader = document.getElementById('loader');
        loader.style.display = 'flex';
        imageMode = 'LOCAL';
        updateImageModeBtn();
        
        itemsDB = []; hideoutDB = []; allImages.clear();

        for (const f of files) {
            if (f.type.startsWith('image/')) {
                const path = f.webkitRelativePath.split('/').slice(1).join('/').toLowerCase();
                allImages.set(path, URL.createObjectURL(f));
            } else if (f.name.endsWith('.json')) {
                const content = JSON.parse(await f.text());
                if (f.webkitRelativePath.includes('hideout')) hideoutDB.push(content);
                else itemsDB.push(content);
            }
        }
        enableUI();
    }

    function render() {
        const grid = document.getElementById('grid-container');
        grid.innerHTML = "";
        const search = document.getElementById('searchInput').value.toLowerCase();
        const baseUrl = (imageMode === 'REMOTE') ? GITHUB_RAW : '';

        let source = (currentSection === 'OFFICINA') ? hideoutDB : itemsDB;

        let filtered = source.filter(item => {
            const name = (item.name?.it || item.name?.en || item.id || "").toLowerCase();
            if (search && !name.includes(search)) return false;

            const type = (item.type || "").toLowerCase();
            const isBP = type.includes('blueprint') || type.includes('schematic');

            // Navigazione Sezioni
            if (currentSection === 'PROGETTI') { if (!isBP) return false; }
            else if (currentSection === 'OFFICINA') { /* logic for hideout */ }
            else { if (isBP) return false; } // Inventario non mostra progetti

            // Filtri Sidebar (Logica Categorie)
            if (currentFilter === 'ALL') return true;
            if (currentFilter === 'ARMI') return type.includes('weapon') || type.includes('rifle') || type.includes('pistol') || type.includes('shotgun');
            if (currentFilter === 'MATERIALI') return type.includes('material') || type.includes('resource');
            if (currentFilter === 'POTENZIAMENTI') return type.includes('augment');
            if (currentFilter === 'SCUDI') return type.includes('shield');
            if (currentFilter === 'MUNIZIONI') return type.includes('ammunition') || type.includes('ammo');
            if (currentFilter === 'MOD') return type.includes('modification') || type.includes('gadget');
            if (currentFilter === 'USO_RAPIDO') return type.includes('quick') || type.includes('consumable');
            if (currentFilter === 'CHIAVI') return type.includes('key');
            
            // Filtro specifico Officina
            if (currentSection === 'OFFICINA' && item.id !== currentFilter) return false;

            return false;
        });

        filtered.forEach(data => {
            const slot = document.createElement('div');
            slot.className = `slot ${(data.rarity || 'common').toLowerCase()}`;
            
            let imgUrl = "";
            if (currentSection === 'OFFICINA') {
                imgUrl = `${baseUrl}images/menu/${data.id.toLowerCase()}.png`;
            } else {
                if (imageMode === 'REMOTE') {
                    imgUrl = data.imageFilename ? (GITHUB_RAW + data.imageFilename.replace(/\\/g, '/')) : "";
                } else {
                    imgUrl = allImages.get(`images/items/${data.id.toLowerCase()}.png`) || "";
                }
            }

            slot.innerHTML = `<img src="${imgUrl}" onerror="this.style.opacity='0'">`;
            grid.appendChild(slot);
        });
    }

    function toggleImageMode() {
        imageMode = (imageMode === 'LOCAL') ? 'REMOTE' : 'LOCAL';
        updateImageModeBtn();
        renderSidebar();
        render();
    }

    function updateImageModeBtn() {
        const btn = document.getElementById('imgModeBtn');
        btn.innerText = `IMG: ${imageMode}`;
        btn.classList.toggle('active', imageMode === 'REMOTE');
    }

    function enableUI() {
        document.body.classList.add('db-loaded');
        document.getElementById('searchInput').disabled = false;
        document.getElementById('loader').style.display = 'none';
        setSection('INVENTARIO');
    }
</script>

</body>
</html>
<!-- VERSIONING: v1.5.0 | REPO: atarufox/Speranza-Archive | UPDATED: Jan 2025 -->